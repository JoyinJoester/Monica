(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();function _(){const e=document.getElementById("lightbox"),s=document.getElementById("lightbox-img");if(!e||!s)return;document.querySelectorAll(".markdown-body img, .glass-card[src], .app-mockup").forEach(o=>{o.style.cursor="zoom-in",o.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),s.src=o.src,e.classList.add("active")})}),e.addEventListener("click",()=>{e.classList.remove("active")})}function S(){const e=document.querySelector("header");e&&window.addEventListener("scroll",()=>{window.scrollY>50?(e.style.background="var(--glass-bg)",e.style.boxShadow="0 4px 20px rgba(0,0,0,0.1)",e.style.backdropFilter="blur(20px)"):(e.style.background="transparent",e.style.boxShadow="none",e.style.backdropFilter="blur(12px)")})}const D={currentLang:localStorage.getItem("monica_lang")||"zh",locales:{},async init(){await this.loadLocale(this.currentLang),this.updateUI(),this.bindEvents()},async loadLocale(e){try{const s=await fetch(`./locales/${e}.json`);this.locales[e]=await s.json()}catch(s){console.error("Failed to load locale:",s)}},updateUI(){const e=this.locales[this.currentLang];e&&(document.querySelectorAll("[data-i18n]").forEach(s=>{const o=s.getAttribute("data-i18n").split(".").reduce((n,i)=>n&&n[i],e);o&&(s.innerHTML=o)}),document.getElementById("current-lang").textContent=this.currentLang.toUpperCase())},bindEvents(){const e=document.getElementById("lang-toggle");e&&(e.onclick=async()=>{const s=this.currentLang==="zh"?"en":"zh";await this.loadLocale(s),this.currentLang=s,localStorage.setItem("monica_lang",s),this.updateUI()})}};function M(e){const s=document.getElementById("commit-chart");if(!s)return;const t=s.getContext("2d"),o=window.devicePixelRatio||1,n=s.getBoundingClientRect();s.width=n.width*o,s.height=n.height*o,t.scale(o,o);const i=new Date,u=new Array(6).fill(0),x=[];for(let d=5;d>=0;d--){const c=new Date(i);c.setDate(c.getDate()-d*5),x.push(`${c.getMonth()+1}/${c.getDate()}`)}e.forEach(d=>{const c=new Date(d.date),h=Math.abs(i-c),f=Math.ceil(h/(1e3*60*60*24));if(f<=30){const g=5-Math.floor((f-1)/5);g>=0&&g<6&&u[g]++}});const a=40,r=n.width,l=n.height,m=r-a*2,p=l-a*2,b=Math.max(...u,5);t.clearRect(0,0,r,l),t.strokeStyle="rgba(255, 255, 255, 0.1)",t.fillStyle="rgba(255, 255, 255, 0.5)",t.font="10px Inter",t.textAlign="center",x.forEach((d,c)=>{const h=a+c/5*m,f=l-a+20;t.fillText(d,h,f)}),t.beginPath(),u.forEach((d,c)=>{const h=a+c/5*m,f=d/b,g=l-a-f*p;if(c===0)t.moveTo(h,g);else{const v=a+(c-1)/5*m,w=u[c-1]/b,L=l-a-w*p,E=v+(h-v)/2,k=L,I=v+(h-v)/2,$=g;t.bezierCurveTo(E,k,I,$,h,g)}});const y=t.createLinearGradient(0,0,r,0);y.addColorStop(0,"#006495"),y.addColorStop(1,"#00a8cc"),t.strokeStyle=y,t.lineWidth=3,t.stroke(),t.lineTo(a+m,l-a),t.lineTo(a,l-a),t.closePath(),t.fillStyle="rgba(0, 168, 204, 0.1)",t.fill(),u.forEach((d,c)=>{const h=a+c/5*m,f=d/b,g=l-a-f*p;t.beginPath(),t.arc(h,g,4,0,Math.PI*2),t.fillStyle="#fff",t.fill(),t.fillStyle="rgba(255,255,255,0.8)",t.fillText(d,h,g-10)})}const C="JoyinJoester",P="Monica";async function B(){const e={Accept:"application/vnd.github+json"},s=`https://api.github.com/repos/${C}/${P}`,[t,o,n]=await Promise.all([fetch(s,{headers:e,cache:"no-store"}),fetch(`${s}/commits?per_page=30`,{headers:e,cache:"no-store"}),fetch(`${s}/contributors?per_page=30`,{headers:e,cache:"no-store"})]);if(!t.ok||!o.ok||!n.ok)throw new Error(`GitHub API failed: repo=${t.status}, commits=${o.status}, contributors=${n.status}`);const i=await t.json(),u=await o.json(),x=await n.json(),a=x.reduce((r,l)=>r+(l.contributions||0),0);return{stats:{stars:i.stargazers_count||0,forks:i.forks_count||0,issues:i.open_issues_count||0},commits:u.map(r=>{var l,m,p,b,y;return{sha:(r.sha||"").slice(0,7),author:((m=(l=r.commit)==null?void 0:l.author)==null?void 0:m.name)||"unknown",message:(((p=r.commit)==null?void 0:p.message)||"").split(`
`)[0],date:((y=(b=r.commit)==null?void 0:b.author)==null?void 0:y.date)||new Date().toISOString(),url:r.html_url||"#"}}),contributors:x.map(r=>({login:r.login,avatar_url:r.avatar_url,html_url:r.html_url,contributions:r.contributions||0,ratio:a>0?Math.round((r.contributions||0)/a*100):0}))}}async function T(){const e=await fetch(`./data/github-data.json?v=${Date.now()}`,{cache:"no-store"});if(!e.ok)throw new Error(`Local github-data.json fetch failed: ${e.status}`);return e.json()}async function z(){const e=document.getElementById("commit-timeline"),s=document.getElementById("contributors-list");try{let t;try{t=await B()}catch(o){console.warn("Live GitHub fetch failed, falling back to cached data.",o),t=await T()}t.commits&&t.commits.length>0&&(e.innerHTML=t.commits.slice(0,6).map((o,n)=>`
            <div style="display: flex; gap: 12px; position: relative;">
                <div style="width: 2px; background: var(--sys-light-outline-variant); margin-left: 6px;"></div>
                <div style="flex: 1; padding-bottom: 20px;">
                    <div style="position: absolute; left: 0; width: 14px; height: 14px; background: var(--sys-light-primary); border-radius: 50%; border: 2px solid white;"></div>
                    <div style="margin-left: 10px;">
                        <div style="font-size: 0.85rem; color: var(--sys-light-secondary);">${new Date(o.date).toLocaleDateString()}</div>
                        <div style="font-weight: 500; margin-top: 4px;">${o.message}</div>
                        <a href="${o.url}" target="_blank" style="font-size: 0.8rem; color: var(--sys-light-primary); opacity: 0.8;">${o.sha} by ${o.author}</a>
                    </div>
                </div>
            </div>
        `).join(""),M(t.commits)),t.stats&&(document.getElementById("stat-stars").textContent=t.stats.stars,document.getElementById("stat-forks").textContent=t.stats.forks,document.getElementById("stat-issues").textContent=t.stats.issues),t.contributors&&t.contributors.length>0&&(s.innerHTML=t.contributors.map(o=>`
            <a href="${o.html_url}" target="_blank" title="${o.login}: ${o.contributions} commits (${o.ratio}%)" style="position: relative; transition: transform 0.2s;">
                <img src="${o.avatar_url}" style="width: 48px; height: 48px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="position: absolute; bottom: 0; right: 0; background: var(--sys-light-primary); color: white; font-size: 10px; padding: 1px 4px; border-radius: 4px;">${o.ratio}%</div>
            </a>
        `).join(""))}catch(t){console.log("No GitHub data found, skipping render.",t)}}document.addEventListener("DOMContentLoaded",()=>{_(),S(),D.init(),z(),console.log("%c Monica ","background: #006495; color: #fff; border-radius: 4px; padding: 4px;","Welcome to the safe zone.")});export{_ as i};
